@echo off
:: ultimate_cleaner_win11_v1.5.bat
:: –ö—Ä–∞—Å–æ—á–Ω—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ—á–∏—Å—Ç–∏—Ç–µ–ª—å Windows 11 (25H2 –∏ –¥—Ä.)
:: –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –æ—Ä–∞–Ω–∂–µ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞
:: –¢—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

chcp 65001 >nul
setlocal EnableDelayedExpansion

:: –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è
set "currentVer=1.5"

:: –¶–≤–µ—Ç–∞ ANSI
set "C_WHITE=[97m"
set "C_GREEN=[92m"
set "C_RED=[91m"
set "C_ORANGE=[93m"   :: –Ø—Ä–∫–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π (–Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —è—Ä–∫–æ-–∂—ë–ª—Ç—ã–π)
set "C_CYAN=[96m"
set "C_MAGENTA=[95m"
set "C_RESET=[0m"

:: –ì–∞–ª–æ—á–∫–∞ –∏ –∫—Ä–µ—Å—Ç
set "C_CHECK=[92m‚úî[0m"
set "C_FAIL=[91m‚úò[0m"
set "C_WARN=[93m‚ö†[0m"

:: ==== –§–ª–∞–≥ –†–æ—Å—Å–∏–∏ (–≤ –Ω–∞—á–∞–ª–µ) ====
echo [97m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà[0
echo [94m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà[0
echo [91m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà[0
echo.

:: === –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ ===
:progress
setlocal EnableDelayedExpansion
set "barLen=20"
set /a filled=%1 * barLen / 100
set "bar=%C_ORANGE%["
for /l %%i in (1,1,!filled!) do set "bar=!bar!*"
for /l %%i in (!filled!,1,%barLen%) do set "bar=!bar! "
set "bar=!bar!] %1%%%C_RESET%"
echo !bar! %C_ORANGE% - %2%C_RESET%
endlocal & goto :eof

:askEnter
echo.
set /p ANSWER="–•–æ—Ç–∏—Ç–µ –ø–æ–ø–∞—Å—Ç—å –≤ –º–µ–Ω—é –æ—á–∏—Å—Ç–∫–∏? (–î/–ù):"
if /I "%ANSWER%"=="–î" goto mainMenu
if /I "%ANSWER%"=="–ù" goto endFlag
echo –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –î –∏–ª–∏ –ù.
goto askEnter

:mainMenu
cls
echo %C_CYAN%==========================================%C_RESET%
echo %C_CYAN%   ULTIMATE CLEANER ‚Äì Windows 11 v%currentVer%   %C_RESET%
echo %C_CYAN%==========================================%C_RESET%
echo.

echo %C_WHITE%12. Edge (–ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)%C_RESET%
echo %C_WHITE%25. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã%C_RESET%
echo %C_WHITE%23. –í—ã—Ö–æ–¥%C_RESET%
echo.

set /p CHOICE="–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –º–µ–Ω—é: "

if "%CHOICE%"=="12" goto remEdge
if "%CHOICE%"=="25" goto checkUpdate
if "%CHOICE%"=="23" goto endFlag

goto mainMenu

:: === –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π ===
:checkUpdate
echo %C_ORANGE%[!] –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π...%C_RESET%
for /f "tokens=* delims=" %%A in ('curl -s https://raw.githubusercontent.com/Vastega/Vastega-ultimate_cleaner_win11/main/version.txt') do (
    set "latestVer=%%A"
)
echo –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: %currentVer%
echo –î–æ—Å—Ç—É–ø–Ω–∞—è –≤–µ—Ä—Å–∏—è: !latestVer!

if "%currentVer%"=="!latestVer!" (
    echo %C_CHECK% –£ –≤–∞—Å —É–∂–µ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è %currentVer%.
) else (
    echo %C_WARN% –î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è: !latestVer! .
    echo –ó–∞–π–¥–∏—Ç–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π GitHub –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏.
)
pause
goto mainMenu

:: === –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ Edge —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º ===
:remEdge
cls
echo %C_ORANGE%[!] –ó–∞–ø—É—â–µ–Ω–æ –ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ Microsoft Edge...%C_RESET%
echo.

call :progress 10 "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ Edge"
taskkill /F /IM msedge.exe >nul 2>&1
taskkill /F /IM msedgewebview2.exe >nul 2>&1
taskkill /F /IM msedgeupdate.exe >nul 2>&1
taskkill /F /IM MicrosoftEdgeUpdate.exe >nul 2>&1

call :progress 30 "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–ª—É–∂–±"
sc stop edgeupdate >nul 2>&1
sc config edgeupdate start= disabled >nul 2>&1
sc stop edgeupdatem >nul 2>&1
sc config edgeupdatem start= disabled >nul 2>&1

call :progress 50 "–£–¥–∞–ª–µ–Ω–∏–µ UWP-–ø–∞–∫–µ—Ç–æ–≤"
powershell -command "Get-AppxPackage *Microsoft.MicrosoftEdge* | Remove-AppxPackage -AllUsers" >nul 2>&1
powershell -command "Get-AppxProvisionedPackage -Online | where {$_.DisplayName -like '*Microsoft.MicrosoftEdge*'} | Remove-AppxProvisionedPackage -Online" >nul 2>&1

call :progress 70 "–£–¥–∞–ª–µ–Ω–∏–µ –ø–∞–ø–æ–∫ Edge"
rd /s /q "%ProgramFiles(x86)%\Microsoft\Edge" >nul 2>&1
rd /s /q "%ProgramFiles(x86)%\Microsoft\EdgeUpdate" >nul 2>&1
rd /s /q "%ProgramFiles(x86)%\Microsoft\EdgeCore" >nul 2>&1
rd /s /q "%ProgramFiles%\Microsoft\Edge" >nul 2>&1
rd /s /q "%ProgramFiles%\Microsoft\EdgeUpdate" >nul 2>&1
rd /s /q "%ProgramFiles%\Microsoft\EdgeCore" >nul 2>&1
rd /s /q "%LOCALAPPDATA%\Microsoft\Edge" >nul 2>&1
rd /s /q "%LOCALAPPDATA%\Microsoft\EdgeUpdate" >nul 2>&1
rd /s /q "%LOCALAPPDATA%\Microsoft\EdgeCore" >nul 2>&1

call :progress 85 "–£–¥–∞–ª–µ–Ω–∏–µ WebView"
rd /s /q "%ProgramFiles(x86)%\Microsoft\EdgeWebView" >nul 2>&1
rd /s /q "%ProgramFiles%\Microsoft\EdgeWebView" >nul 2>&1
rd /s /q "%LOCALAPPDATA%\Microsoft\EdgeWebView" >nul 2>&1

call :progress 95 "–û—á–∏—Å—Ç–∫–∞ —Ä–µ–µ—Å—Ç—Ä–∞"
reg delete "HKLM\SOFTWARE\Microsoft\EdgeUpdate" /f >nul 2>&1
reg delete "HKLM\SOFTWARE\WOW6432Node\Microsoft\EdgeUpdate" /f >nul 2>&1
reg delete "HKCU\Software\Microsoft\EdgeUpdate" /f >nul 2>&1

:: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤/–ø—Ä–æ—Ü–µ—Å—Å–æ–≤
set "edgeLeft=0"
tasklist | find /i "msedge.exe" >nul && set "edgeLeft=1"
if exist "%ProgramFiles(x86)%\Microsoft\Edge" set "edgeLeft=1"
if exist "%ProgramFiles%\Microsoft\Edge" set "edgeLeft=1"
if exist "%LOCALAPPDATA%\Microsoft\Edge" set "edgeLeft=1"

call :progress 100 "–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤"
if "!edgeLeft!"=="0" (
    echo %C_CHECK% Microsoft Edge –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—ë–Ω.
) else (
    echo %C_FAIL% Microsoft Edge —É–¥–∞–ª—ë–Ω —á–∞—Å—Ç–∏—á–Ω–æ, –æ—Å—Ç–∞–ª–∏—Å—å —Å–ª–µ–¥—ã.
)
pause
goto mainMenu

:endFlag
:: ==== –§–ª–∞–≥ –†–æ—Å—Å–∏–∏ (–≤ –∫–æ–Ω—Ü–µ) ====
echo [97m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà[0
echo [94m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà[0
echo [91m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà[0
pause
exit /b
